/*
 * File: app/store/GroupFolderStore.js
 *
 * This file was generated by Sencha Architect version 2.2.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('TeamDomain.store.GroupFolderStore', {
    extend: 'Ext.data.Store',
    requires: [
        'TeamDomain.model.GroupData'
    ],
    constructor: function (cfg) {
        var me = this;
        cfg = cfg || {};
        me.callParent([Ext.apply({
                model: 'TeamDomain.model.GroupData',
                storeId: 'GroupFolderStore',
                proxy: {
                    type: 'ajax',
                    url: 'spin/group_list_folder.sfl',
                    reader: {
                        type: 'json',
                        root: 'groups'
                    }
                },
                listeners:
                        {
                            load: function (me, records)
                            {
                                Ext.apply(me.proxy.extraParams,
                                        {
                                            add_flag:1
                                        });
                                Ext.getCmp('first_flag').setValue(1);
                            },
                            beforeload: function (me)
                            {
                                var first_flag=Ext.getCmp('first_flag').value;
                                if (first_flag === 0)
                                {
                                    var target = Ext.getCmp('opend_by').value;
                                    var grid = Ext.getCmp(target);
                                    var model = grid.getSelectionModel();
                                    var record = model.getSelection()[0];
                                    var hash_key = record.data.hash_key;
                                    Ext.apply(me.proxy.extraParams,
                                            {
                                                hash_key: hash_key,
                                                target:target
                                            });
                                }
                                else
                                {
                                    var target = Ext.getCmp('opend_by').value;
                                    var hash_key=Ext.getCmp('hash_key').value;
                                    Ext.apply(me.proxy.extraParams,
                                            {
                                                hash_key: hash_key,
                                                target:target
                                            });
                                }
                                
                            }
                        }
            }, cfg)]);
    }
});
